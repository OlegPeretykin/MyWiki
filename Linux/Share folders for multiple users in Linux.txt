общий каталог для нескольких пользователей в Linux

видимо перевод с испанского

Сегодня я возвращаюсь с еще одним советом, который лично я использую очень часто: иметь возможность иметь общий каталог для нескольких пользователей на Linux. Я поставил их в ситуацию, когда моя жена дома, мы оба используем один компьютер с Arch Linux но у каждого свой пользователь. Итак, мы заметили проблему с теми папками, которыми мы делимся, например, музыкой или фотографиями, поскольку в каждой из них были свои файлы, дублирующие друг друга.

Тогда мы подумали сделать общую папку, но есть проблема с разрешениями. Если папка моя, она ее не видит, если файл, который я создаю, она не удаляет и так далее. Вначале патч заключался в том, что мы давали 777 разрешений этим файлам каждый раз, когда мы редактировали что-то для доступа другого, пока не нашли решение, Групповые разрешения!



1 Что такое разрешения группы?
2 А как мне его настроить?
3 Редактирование маски
Что такое разрешения группы?
Это лучшее, назначьте этот общий каталог и все его содержимое специальной группе с разрешениями на чтение и запись, с которым все члены группы будут иметь доступ к указанному каталогу. Затем это позволяет, просто добавляя наших пользователей в эту группу, мы уже можем взаимодействовать в этом каталоге.

А как мне его настроить?
Это лучшая часть, и я продолжу рассказывать вам, как я сделал это со своей женой. Первое, что нужно сделать - это создать каталог, который в примере я назову «поделился».

sudo mkdir /home/compartido

Я создаю его внутри / home и за пределами наших учетных записей, чтобы верхние каталоги не беспокоились о своих разрешениях. Теперь мы должны создать группу, которую мы поместим «общий»

sudo groupadd compartidos

И мы назначаем эту группу каталогу, который мы создали ранее, и мы также изменяем разрешения, чтобы все, что мы создаем внутри, будь то каталоги или файлы, также принадлежало этой группе.

sudo chgrp -R compartidos /home/compartido
sudo chmod g+s /home/compartido

Кроме того, мы должны добавить в него наших пользователей. Затем мы должны повторить эту команду для каждого:

sudo usermod -G compartido sebastian
sudo usermod -G compartido mimujer

Пока у нас есть каталог «/ home / общий»Которая принадлежит к группе«общий«, С чем будут иметь доступ все пользователи-члены того же самого, и все, что создано в каталоге, будет принадлежать к группе, с чем любой из нас сможет их видеть.

Теперь нам нужен только один последний шаг, который может быть необязательным, но он заключается в изменении umask пользователей, чтобы гарантировать, что каждый новый файл, который мы создаем, может быть изменен другими членами группы. Это влияет на всех пользователей, а не только на каталог, поэтому они должны видеть, работает это для них или нет. В моем случае, поскольку систему используем только мы с женой, это нас не беспокоит, и мы назначаем umask 002, что означает, что каждый созданный файл начинается с 775 разрешений.

Редактирование маски
Чтобы отредактировать umask, каждый пользователь должен отредактировать файл .profile или .bashrc, который находится внутри дома пользователя, и изменить значение umask на желаемое число. Если опции нет, мы должны ее добавить.

!!!!! Вы также можете отредактировать файл / etc / profile, чтобы изменения коснулись всех пользователей !!!!

Итак, в консоли ставим:

sebastian@multivacs ~> vim .profile

И мы увидим что-то вроде этого:
#umask 022

Итак, переходим к строке с надписью umask, нажимаем букву i чтобы иметь возможность редактировать, и мы удаляем #, чтобы удалить комментарий. Меняем номер на 002. Если строка не появляется, они должны ее добавить.

Закончив, нажимаем клавишу Esc чтобы выйти из режима редактирования, а затем мы пишем :+q+w. Что заставляет нас сохранить изменения и выйти из Vi.

Это будет выглядеть так:

vi-профиль
И все! Если они закроют свою пользовательскую сессию и снова откроют ее, будут приняты изменения, с которыми общий каталог уже будет работать.
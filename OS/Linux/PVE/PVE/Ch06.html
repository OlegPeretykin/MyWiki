<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="font-awesome.css" tppabs="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet"/>
<title>Глава 6. Виртуальные машины KVM - Proxmox. Полное руководство. 3е изд.</title>
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"/>
<meta name="mavenGroupId" content="www.mdl.ru"/>
<meta name="MasteringProxmox3ed"/>
<meta name="mavenVersionId" content="1.0.0"/>
<link rel="home" href="index.html" title="Proxmox. Полное руководство. 3е изд."/>
<link rel="up" href="index.html" title="Proxmox. Полное руководство. 3е изд."/>
<link rel="prev" href="Ch05.html" title="Глава 5. Установка и настройка Ceph"/>
<link rel="next" href="Ch07.html" title="Глава 7. Виртуальные машины LXC"/>
<meta name="git-sha" content=""/>
<meta name="buildTime" content=""/>
<script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "mastering-proxmox-3ed";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
</script>
<style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(folder.gif)/*tpa=http://onreader.mdl.ru/common/jquery/treeview/images/folder.gif*/ 0 0px no-repeat;
            }
</style>
<link rel="shortcut icon" href="MdlLogo.gif" tppabs="http://onreader.mdl.ru/MdlLogo.gif" type="image/gif"/>
<link rel="stylesheet" type="text/css" href="positioning.css" tppabs="http://onreader.mdl.ru/common/css/positioning.css"/>
<link rel="stylesheet" type="text/css" href="custom.css" tppabs="http://onreader.mdl.ru/common/css/custom.css"/>
<link rel="canonical" href="http://onreader.mdl.ru/MasteringProxmox3ed/content/index.html"/>
<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="ie.css" tppabs="http://onreader.mdl.ru/common/css/ie.css"/>
<![endif]-->
<link rel="stylesheet" type="text/css" href="jquery-ui-1.8.2.custom.css" tppabs="http://onreader.mdl.ru/common/jquery/theme-redmond/jquery-ui-1.8.2.custom.css"/>
<link rel="stylesheet" type="text/css" href="jquery.treeview.css" tppabs="http://onreader.mdl.ru/common/jquery/treeview/jquery.treeview.css"/>
<script type="text/javascript" src="jquery-1.11.0.min.js" tppabs="http://code.jquery.com/jquery-1.11.0.min.js"><!----></script>
<script type="text/javascript" src="jquery-ui-1.8.2.custom.min.js" tppabs="http://onreader.mdl.ru/common/jquery/jquery-ui-1.8.2.custom.min.js"><!----></script>
<script type="text/javascript" src="jquery.cookie.js" tppabs="http://onreader.mdl.ru/common/jquery/jquery.cookie.js"><!----></script>
<script type="text/javascript" src="jquery.treeview.min.js" tppabs="http://onreader.mdl.ru/common/jquery/treeview/jquery.treeview.min.js"><!----></script>
<link rel="stylesheet" type="text/css" href="jquery.qtip.min-1.css" tppabs="http://cdn.jsdelivr.net/qtip2/2.2.0/jquery.qtip.min.css"/>
<script type="text/javascript" src="jquery.qtip.min.js" tppabs="http://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/jquery.qtip.min.js">
<!--jQuery plugin for glossary popups. --></script>
<script type="text/javascript" src="htmlFileList.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/search/htmlFileList.js"><!----></script>
<script type="text/javascript" src="htmlFileInfoList.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/search/htmlFileInfoList.js"><!----></script>
<script type="text/javascript" src="nwSearchFnt.js" tppabs="http://onreader.mdl.ru/common/search/nwSearchFnt.js"><!----></script>
<script type="text/javascript" src="en_stemmer.js" tppabs="http://onreader.mdl.ru/common/search/stemmers/en_stemmer.js">
<!--//make this scalable to other languages as well.--></script>
<script type="text/javascript" src="index-1.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/search/index-1.js"><!----></script>
<script type="text/javascript" src="index-2.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/search/index-2.js"><!----></script>
<script type="text/javascript" src="index-3.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/search/index-3.js"><!----></script>
<script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-1']);
	    
	    _gaq.push(['_setDomainName', '.openstack.org']);	        
</script>
<script type="text/javascript" src="ga.js" tppabs="http://onreader.mdl.ru/common/ga.js"><!----></script>
<script language="javascript" src="common.js" tppabs="http://onreader.mdl.ru/js/common.js"></script>
<link rel="stylesheet" href="googlecode.css" tppabs="http://onreader.mdl.ru/common/css/googlecode.css">
<script src="highlight.pack.js" tppabs="http://onreader.mdl.ru/common/highlight.pack.js"></script>
</head>
<body>
<!----><script type="text/javascript"><!--
hljs.initHighlightingOnLoad();
HeaderName = 'Глава 6. Виртуальные машины KVM';
PrevRef = 'Ch05.html'/*tpa=http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch05.html*/;
UpRef = 'index.html'/*tpa=http://onreader.mdl.ru/MasteringProxmox.3ed/content/index.html*/;
NextRef = 'Ch07.html'/*tpa=http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch07.html*/;//--></script>
<!----><script type="text/javascript" src="HeaderAndToolbar.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/HeaderAndToolbar.js">
</script><script type="text/javascript"><!--
document.write(HeaderAndToolbar); //-->
</script>
<div id="content">
 <div class="part">
  <div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title">
   Глава 6. Виртуальные машины KVM
  </div></div></div>

  <div class="toc"><p><strong>Содержание</strong></p>
   <dl>
     <dt><span class="chapter"><a href="Ch06.html" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html">Глава 6. Виртуальные машины KVM</a></span></dt>
     <dd><dl>
       <dt><span class="chapter"><a href="Ch06.html#01" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#01">Обзор KVM</a></span></dt>
       <dt><span class="chapter"><a href="Ch06.html#02" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02">Создание KVM</a></span></dt>
       <dd><dl>
         <dt><span class="chapter"><a href="Ch06.html#0201" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0201">Создание KVM с помощью образа ISO</a></span></dt>
         <dd><dl>
           <dt><span class="chapter"><a href="Ch06.html#020101" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020101">Закладка General</a></span></dt>
           <dd><dl>
             <dt><span class="chapter"><a href="Ch06.html#02010101" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010101">Node</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010102" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010102">VM ID</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010103" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010103">Name</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010104" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010104">Resource Pool</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010105" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010105">Help</a></span></dt>
       </dl></dd>
           <dt><span class="chapter"><a href="Ch06.html#020102" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020102">Закладка OS</a></span></dt>
           <dt><span class="chapter"><a href="Ch06.html#020103" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020103">Закладка CD/DVD</a></span></dt>
           <dt><span class="chapter"><a href="Ch06.html#020104" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020104">Закладка Hard Disk</a></span></dt>
           <dd><dl>
             <dt><span class="chapter"><a href="Ch06.html#02010401" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010401">Bus/Device</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010402" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010402">Storage</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010403" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010403">Disk Size (GB)</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010404" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010404">Format</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010405" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010405">Cache</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010406" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010406">No backup</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010407" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010407">Discard</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010408" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010408">IO thread</a></span></dt>
       </dl></dd>
           <dt><span class="chapter"><a href="Ch06.html#020105" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020105">Закладка CPU</a></span></dt>
           <dd><dl>
             <dt><span class="chapter"><a href="Ch06.html#02010501" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010501">Sockets</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010502" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010502">Cores</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010503" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010503">Enabling NUMA</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010504" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010504">Type</a></span></dt>
       </dl></dd>
           <dt><span class="chapter"><a href="Ch06.html#020106" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020106">Закладка Memory</a></span></dt>
           <dt><span class="chapter"><a href="Ch06.html#020107" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020107">Закладка Network</a></span></dt>
           <dd><dl>
             <dt><span class="chapter"><a href="Ch06.html#02010701" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010701">Bridged mode</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010702" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010702">Firewall</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010703" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010703">NAT mode</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010704" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010704">No network device</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010705" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010705">Model</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010706" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010706">MAC address</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010707" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010707">Rate limit (MB/s)</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010708" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010708">Multiqueues</a></span></dt>
             <dt><span class="chapter"><a href="Ch06.html#02010709" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#02010709">Disconnect</a></span></dt>
         </dl></dd>
       </dl></dd>
         <dt><span class="chapter"><a href="Ch06.html#0202" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0202">Создание ВМ клонированием</a></span></dt>
         <dt><span class="chapter"><a href="Ch06.html#0203" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0203">Создание ВМ из шаблона</a></span></dt>
         <dd><dl>
           <dt><span class="chapter"><a href="Ch06.html#020301" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020301">Узел назначения</a></span></dt>
           <dt><span class="chapter"><a href="Ch06.html#020302" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020302">Режим</a></span></dt>
         </dl></dd>
       </dl></dd>
       <dt><span class="chapter"><a href="Ch06.html#03" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#03">Расширенные параметры настройки для ВМ</a></span></dt>
       <dd><dl>
         <dt><span class="chapter"><a href="Ch06.html#0301" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0301">Настройка звуковых устройств</a></span></dt>
         <dt><span class="chapter"><a href="Ch06.html#0302" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0302">Настройка проброса PCI</a></span></dt>
         <dt><span class="chapter"><a href="Ch06.html#0303" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0303">Настройка проброса GPU</a></span></dt>
         <dt><span class="chapter"><a href="Ch06.html#0304" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0304">Подготовка к подключению во время работы</a></span></dt>
         <dt><span class="chapter"><a href="Ch06.html#0305" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#0305">Настройка подключения во время работы</a></span></dt>
         <dd><dl>
           <dt><span class="chapter"><a href="Ch06.html#020501" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020501">Подключение vCPU в горячем режиме</a></span></dt>
           <dt><span class="chapter"><a href="Ch06.html#020502" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020502">Подключение оперативной памяти в горячем режиме</a></span></dt>
           <dt><span class="chapter"><a href="Ch06.html#020503" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020503">Подключение дисков/ vNIC в горячем режиме</a></span></dt>
         </dl></dd>
       </dl></dd>
       <dt><span class="chapter"><a href="Ch06.html#04" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#04">Миграция виртуальных машин KVM</a></span></dt>
       <dt><span class="chapter"><a href="Ch06.html#05" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#05">Выводы</a></span></dt>
     </dl></dd>
   </dl>
  </div>
  <p>На текущий момент мы познакомились с графическим интерфейсом пользователя Proxmox, файлами настройки, 
  а также структурой каталога. Мы также изучили различные типы поддерживаемых Proxmox хранилищ и то, как их 
  интегрировать в кластер. В этой главе мы собираемся сделать шаг вперёд и рассмотреть 
  <span class="term"><strong class="userinput">KVM</strong></span> (<span class="term"><strong 
  class="userinput">Kernel-based Virtual Machine</strong></span>) и всё, что они должны предложить. Мы 
  собираемся рассмотреть следующие темы:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p>Обзор виртуальных машин KVM</p>
	 </li><li class="listitem">
	 <p>Создание виртуальных машин KVM</p>
	 </li><li class="listitem">
	 <p>Настройку виртуальных машин KVM</p>
	 </li><li class="listitem">
	 <p>Миграцию виртуальных машин KVM</p>
	 </li><li class="listitem">
	 <p>Встраиваемые виртуальные среды</p>
	 </li><li class="listitem">
	 <p>Систему резервного копирования/ восстановления Proxmox</p>
	 </li><li class="listitem">
	 <p>Моментальные снимки виртуальных машин</p>
	 </li>
    </ul>
    </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="01"> </a>Обзор KVM</h3>
   </div></div></div>
   <p>Как и подразумевает их название, KVM добавляют возможности гипервизора в ядро Linux. KVM позволяют вам
   создавать полностью изолированные виртуальные машины, которые не зависят от операционной системы или ядра хоста. 
   Изолированность создаётся путём эмуляции определённых элементов оборудования, таких как ЦПУ, ОЗУ, звуковые/ видео/ 
   сетевые карты, мосты PCI, а также устройства ввода. Чтобы создавать виртуальные машины KVM, ЦПУ в его машине хоста 
   должен иметь <span class="term"><strong class="userinput">аппаратные расширения виртуализации</strong></span>
   (<span class="term"><strong class="userinput">HWE</strong></span>, 
   <span class="term"><strong class="userinput">hardware virtualization extensions</strong></span>). 
   KVM/Qemu создаёт некий уровень, который виртуализирует физическое оборудование, что делает возможной полную 
   виртуализацию системы в отличие от виртуализации уровня ядра, как это имеет место в случае контейнеров OpenVZ и
   LXC. Это делает возможной виртуализацию широкого диапазона операционных систем, таких как Linux, BSD, 
   Windows и macOS. Одно из основных отличий KVM и виртуальных машин на основе контейнеров состоит в том, что ресурсы 
   KVM совместно используются на аппаратном уровне, в то время как виртуальные машины уровня контейнера разделяются на 
   уровне ядра. Таким образом, плотность общего числа ВМ KVM на узле намного меньше чем у контейнеров. KVM являются 
   единственным выбором для не- Linux операционных систем и для ориентированных на выполнение определённой 
   задачи операционных систем, таких как ClearOS, FreeNAS, Zentyal.</p>
   <p>Для получения дополнительной информации по KVM обратитесь к 
   <a class="link" href="javascript:if(confirm(%27https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine%27" tppabs="https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine" 
   target="_top">https://en.wikipedia.org/wiki/Kernel-based_Virtual_Machine</a>
   {<span class="emphasis"><em>Прим. пер.: или к русскоязычной странице <a class="link" 
   href="javascript:if(confirm(%27https://ru.wikipedia.org/wiki/KVM  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://ru.wikipedia.org/wiki/KVM%27" tppabs="https://ru.wikipedia.org/wiki/KVM" target="_top">https://ru.wikipedia.org/wiki/KVM</a>.</em></span>}</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="02"> </a>Создание KVM</h3>
   </div></div></div>
   <p>В Proxmox мы можем создавать ВМ KVM следующими способами:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p>Из рабочей области с применением ISO</p>
	 </li><li class="listitem">
	 <p>Из шаблона</p>
	 </li><li class="listitem">
	 <p>Применяя загрузку PXE</p>
	 </li>
    </ul>
    </div>
   <p>В этой главе мы намереваемся рассмотреть только создание ВИ из образов ISO и шаблонов.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0201"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Создание KVM с помощью образа ISO</span></h4>
   </div></div></div>
   <p>Создание ВМ основано на простых блоках диалога на базе закладок. На протяжении этого процесса мы должны назначать 
   ресурсы и тип в необходимой информации, принадлежащей определённой ВМ. К блоку диалога можно осуществить доступ кликнув
   кнопку <span class="term"><strong class="userinput">Create VM</strong></span>, расположенную в верхнем правом углу 
   вашего экрана, как это показано на следующем экранном снимке. К нему также можно получить доступ кликнув правой кнопкой 
   по узлу и затем выбрав <span class="term"><strong class="userinput">Create VM</strong></span> из меню контекста:</p>
	 <div class="figure"><a id="Fig0601"> </a>
	  <p class="title"><strong>Рисунок 6-1</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0601.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0601.jpg" width="529" height="109"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>В своём примере кластера мы собираемся создать KVM с названием <span class="term"><code>centos1</code></span>
   в узле <span class="term"><code>pmx-01</code></span>. Чтобы выполнить процесс построения необходимой ВМ просто кликните 
   по кнопке <span class="term"><strong class="userinput">Next</strong></span> или кликните по кнопке 
   <span class="term"><strong class="userinput">Back</strong></span> чтобы вернуться обратно в предыдущую закладку. Следующий 
   экранный снимок отображает соответствующий блок диалога после того как мы нажали на кнопку
   <span class="term"><strong class="userinput">Create VM</strong></span> в GUI Proxmox:</p>
	 <div class="figure"><a id="Fig0602"> </a>
	  <p class="title"><strong>Рисунок 6-2</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0602.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0602.jpg" width="549" height="402"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>

   <a id="020101"> </a>
   <p class="title"><strong>Закладка General</strong></p>
   <p>Закладка <span class="term"><strong class="userinput">General</strong></span> предназначается главным образом для 
   определения идентификационной информации. Давайте взглянем на неё.</p>

   <a id="02010101"> </a>
   <p class="title"><em>Node</em></p>
   <p>Это ниспадающий список для выбора того, на каком из узлов Proxmox следует создать данную ВМ.</p>

   <a id="02010102"> </a>
   <p class="title"><em>VM ID</em></p>
   <p>Этот текстовый блок применяется для ввода численного идентификатора данной ВМ. Мы также можем увеличивать или уменьшать 
   текущее значение <span class="term"><strong class="userinput">VM ID</strong></span> применяя стрелки. Если вы 
   назначили некий идентификатор, который уже имеется в данном кластере, текущий блок отобразит красное окаймление, указывающее 
   что уже имеется некая ВМ с тем же самым идентификатором.</p>

   <a id="02010103"> </a>
   <p class="title"><em>Name</em></p>
   <p>Данный текстовый блок используется для ввода необходимого названия создаваемой ВМ. Мы можем вводить строку из 
   букв и цифр с единственным разрешённым специальным символом дефиса (<span class="term"><code>-</code></span>).</p>

   <a id="02010104"> </a>
   <p class="title"><em>Resource Pool</em></p>
   <p>Это ниспадающее меню применяется для выбора созданного ранее пула. Оно требуется только если вам необходимо назначить 
   данную ВМ в определённый пул. В нашем примере ВМ мы назначаем её в пул с названием 
   <span class="term"><code>Linux_VMs</code></span>.</p>

   <a id="02010105"> </a>
   <p class="title"><em>Help</em></p>
   <p>Кнопка <span class="term"><strong class="userinput">Help</strong></span> откроет новую закладку с установленной 
   документацией, созданной разработчиками Proxmox. Данная документация содержит специфичную информацию, относящуюся к 
   данной закладке. Каждая кнопка <span class="term"><strong class="userinput">Help</strong></span> в различных закладках 
   закреплена за определённым разделом имеющейся документации. URL данной документации является 
   <a class="link" href="javascript:if(confirm(%27https://ip_addr:8006/pve-docs/chapter-qm.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://ip_addr:8006/pve-docs/chapter-qm.html%27" tppabs="https://ip_addr:8006/pve-docs/chapter-qm.html" 
   target="_top">https://ip_addr:8006/pve-docs/chapter-qm.html</a>.</p>

   <a id="020102"> </a>
   <p class="title"><strong>Закладка OS</strong></p>
   <p>Закладка <span class="term"><strong class="userinput">OS</strong></span> применяется для выбора типа гостевой операционной 
   системы, которая будет установлена в данной ВМ. Этот вид выбора делает возможным уведомление строящейся ВМ о 
   той операционной системе, которую мы собираемся устанавливать, и осуществлять регулировки текущей архитектуры на основе 
   выбираемой ОС. В нашем примере ВМ мы выбираем <span class="term"><strong class="userinput">Linux 4.X/3.X/2.6 Kernel</strong></span>, 
   как это отображено на снимке экрана ниже:</p>
	 <div class="figure"><a id="Fig0603"> </a>
	  <p class="title"><strong>Рисунок 6-3</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0603.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0603.jpg" width="564" height="409"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>Для достижения максимальных производительности и надёжности настоятельно рекомендуется выбирать соответствующий 
		тип ОС.</p></td></tr></table>
     </div>

   <a id="020103"> </a>
   <p class="title"><strong>Закладка CD/DVD</strong></p>
   <p>Так как ВМ KVM полностью инкапсулирована и эмулирует некую физическую машину, мы можем загружать эту ВМ или 
   операционную систему только с помощью установленных в виртуальное устройство CD/ DVD образов ISO или через физический 
   диск, подключённый к данному узлу хоста Proxmox. В этой закладке мы можем выбрать будем ли мы применять виртуальный или
   физический диск CD/ DVD, либо выбрать некий образ ISO. Приводимый ниже снимок экрана отображает блок диалога для 
   закладки <span class="term"><strong class="userinput">CD/DVD</strong></span>, в которой мы выбрали ISO CentOS:</p>
	 <div class="figure"><a id="Fig0604"> </a>
	  <p class="title"><strong>Рисунок 6-4</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0604.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0604.jpg" width="581" height="428"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Если мы желаем создать свою ВМ без определения какого- либо образа диска, нам необходимо остановиться на опции
   <span class="term"><strong class="userinput">Do not use any media</strong></span>.</p>

   <a id="020104"> </a>
   <p class="title"><strong>Закладка Hard Disk</strong></p>
   <p>В этой закладке мы определяем все настройки для своего самого первого образа диска ВМ. Снимок экрана ниже показывает 
   блок диалога с настройкой для нашего примера ВМ.</p>
	 <div class="figure"><a id="Fig0605"> </a>
	  <p class="title"><strong>Рисунок 6-5</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0605.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0605.jpg" width="577" height="424"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>

   <a id="02010401"> </a>
   <p class="title"><em>Bus/Device</em></p>
   <p>Для данной опции доступно два ниспадающих меню. Одно для выбора 
   <span class="emphasis"><em>disk image bus type</em></span> (типа шины образа диска) и другое для 
   <span class="emphasis"><em>device ID</em></span> (идентификатора устройства).</p>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>Для максимальной производительности рекомендуется шина VirtIO.</p></td></tr></table>
     </div>
   <p>Для ВМ Windows необходимо выбирать IDE, поскольку Windows не имеет встроенного драйвера для VirtIO. В подобных случаях нам 
   мы можем воспользоваться следующими шагами для добавления возможностей VirtIO в ВМ Windows:</p>
   <div class="orderedlist">
   <ol class="orderedlist" type="1"><li class="listitem">
     <p>Создайте необходимую ВМ с IDE и установите Windows обычным образом.</p>
	 </li><li class="listitem">
     <p>Добавьте второй дисковый образ с требуемой шиной VirtIO и перезагрузитесь в Windows.</p>
	 </li><li class="listitem">
     <p>Выгрузите самый последний драйвер VirtIO для Windows со следующих ссылок и затем загрузите его через виртуальный 
	 диск CD:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p><a class="link" href="javascript:if(confirm(%27https://onreader.mdl.ru:80/​/​fedorapeople.​org/​groups/​virt/​virtio-​win/​direct-downloads/​stable-​virtio/​virtio-​win.​iso  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://onreader.mdl.ru:80/​/​fedorapeople.​org/​groups/​virt/​virtio-​win/​direct-downloads/​stable-​virtio/​virtio-​win.​iso%27" tppabs="https://onreader.mdl.ru:80/​/​fedorapeople.​org/​groups/​virt/​virtio-​win/​direct-downloads/​stable-​virtio/​virtio-​win.​iso" 
	 target="_top">https:/​/​fedorapeople.​org/​groups/​virt/​virtio-​win/​direct-downloads/​stable-​virtio/​virtio-​win.​iso</a></p>
	 </li><li class="listitem">
	 <p><a class="link" href="javascript:if(confirm(%27http://onreader.mdl.ru/​/​www.​linux-​kvm.​org/​page/​WindowsGuestDrivers/​Download_Drivers  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://onreader.mdl.ru/​/​www.​linux-​kvm.​org/​page/​WindowsGuestDrivers/​Download_Drivers%27" tppabs="http://onreader.mdl.ru/​/​www.​linux-​kvm.​org/​page/​WindowsGuestDrivers/​Download_Drivers" 
	 target="_top">http:/​/​www.​linux-​kvm.​org/​page/​WindowsGuestDrivers/​Download_Drivers</a></p>
	 </li>
    </ul>
    </div>
	 </li><li class="listitem">
     <p>Обновите соответствующий драйвер для вновь обнаруженного оборудования под устанавливаемый образ диска 
	 VirtIO.</p>
	 </li><li class="listitem">
     <p>Погасите свою ВМ Windows и зарегистрируйтесь в своей инструментальной панели Proxmox.</p>
	 </li><li class="listitem">
     <p>В закладке <span class="term"><strong class="userinput">Hardware</strong></span> Данной ВМ выберите установленный 
	 образ IDE и кликните <span class="term"><strong class="userinput">Remove</strong></span>. Заметим, что это не удаляет 
	 окончательно указанный образ диска. Такой образ диска теперь будет отображаться как 
	 <span class="term"><strong class="userinput">Unused Disk 0</strong></span>:</p>
	 <div class="figure"><a id="Fig0606"> </a>
	  <p class="title"><strong>Рисунок 6-6</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0606.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0606.jpg" width="442" height="233"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
	 </li><li class="listitem">
     <p>Выберите <span class="term"><strong class="userinput">Unused disk 0</strong></span> и кликните 
	 <span class="term"><strong class="userinput">Edit</strong></span>. Это откроет блок диалога с вариантами для выбора 
	 необходимого типа <span class="term"><strong class="userinput">Bus/Device</strong></span> и прочих вариантов 
	 настройки:</p>
	 <div class="figure"><a id="Fig0607"> </a>
	  <p class="title"><strong>Рисунок 6-7</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0607.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0607.jpg" width="540" height="272"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
	 </li><li class="listitem">
     <p>В этом блоке диалога мы можем выбрать желаемый тип шины и прочие варианты настроек, если они требуются.</p>
	 </li><li class="listitem">
     <p>Кликните по кнопке <span class="term"><strong class="userinput">Add</strong></span> для добавления соответствующего 
	 образа диска обратно в эту ВМ.</p>
	 </li>
   </ol>
   </div>
   <p>Перечисленные шаги нужны для включения в вашей ВМ Windows использования образа диска VirtIO. Раз соответствующий драйвер 
   уже загружен, нт необходимости загружать его для дополнительных образов дисков VirtIO.</p>

   <a id="02010402"> </a>
   <p class="title"><em>Storage</em></p>
   <p>Это ниспадающее меню для выбора соответствующего хранилища, в котором должен сохраняться необходимый образ диска. 
   Одновременно с названием такого хранилища данное ниспадающее меню также отображает общую ёмкость и доступное 
   пространство хранения для подключаемых устройств хранения.</p>

   <a id="02010403"> </a>
   <p class="title"><em>Disk Size (GB)</em></p>
   <p>Это текстовый блок для определения необходимого размера данного устройтва хранения в ГБ. Его значение может бвть 
   только численным. Мы также можем применять стрелки данного текстового блока вверх и вниз для определения требуемого 
   размера диска.</p>

   <a id="02010404"> </a>
   <p class="title"><em>Format</em></p>
   <p>Это ниспадающее меню для выбора типа образа диска. Если мы выбираем хранилище, которое поддерживает только определённый тип 
   диска, тогда варианты этого меню будут отображаться серыми. Например, для нашего примера кластера у нас является выбранным 
   хранилище Ceph RBD, которое может хранить для Proxmox 5.0 только образы <span class="term"><code>.raw</code></span>. 
   Поэтому варианты формата показаны серыми.</p>
   <p>Если мы выбрали необходимый формат образа диска неверно или позднее наши требования изменились на другой формат, мы 
   можем просто воспользоваться вариантом <span class="term"><strong class="userinput">Move disk</strong></span> в 
   соответствующей закладке <span class="term"><strong class="userinput">Hardware</strong></span> для изменения соответствующего 
   формата. Это также можно сделать применив CLI воспользовавшись следующим форматом:</p>
		<pre class="screen"><code><strong>
#qemu-img convert -O &lt;type&gt; &lt;source_image&gt; &lt;destination_image&gt;
		</strong></code></pre>
   <p>Если мы желаем преобразовать образ диска <span class="term"><code>.qcow2</code></span> в 
   <span class="term"><code>.raw</code></span>, команда должна быть следующей:</p>
		<pre class="screen"><code><strong>
#qemu-img convert -O raw vm-101-disk-1.qcow2 vm-101-disk-1.raw
		</strong></code></pre>
   <p>Данная команда великолепно работает для локального хранилища и хранилищ NFS, ZFS и Gluster, однако не применима для 
   RBD. Для изменения соответствующего формата образа диска, хранимого в RBD, воспользуйтесь опцией 
   <span class="term"><strong class="userinput">Move disk</strong></span> в своей инструментальной панели Proxmox. 
   Помимо хранимого в RBD образа диска данный вариант <span class="term"><strong class="userinput">Move disk</strong></span>
   может быть применён для перемещения любого образа диска хранимого в любом хранилище через имеющийся GUI вообще без 
   применения какого- либо CLI. Этот вариант также полезен для перемещения образа диска с одного хранилища на другое 
   без отключения соответствующей ВМ. Перемещение можно выполнять с локального хранилища на совместно используемое и 
   наоборот. Для перемещения образа диска или изменения его формата выберите необходимый образ диска в соответствующей
   закладке <span class="term"><strong class="userinput">Hardware</strong></span> и кликните по 
   <span class="term"><strong class="userinput">Move disk</strong></span> для открытия блока диалога:</p>
	 <div class="figure"><a id="Fig0608"> </a>
	  <p class="title"><strong>Рисунок 6-8</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0608.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0608.jpg" width="326" height="202"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Как показано в предыдущем снимке экрана, для своего примера мы перемещаем некий образ диска 
   <span class="term"><code>.raw</code></span> с RBD в локальное хранилище. Если мы выберем вариант 
   <span class="term"><strong class="userinput">Delete source</strong></span>, он удалит соответствующий файл источника 
   автоматически после окончания преобразования или перемещения. Если эта опция не выбрана, тогда нам придётся удалять 
   такой файл источника вручную. В этом случае файл источника будет отображаться для нас как не используемый образ диска 
   в соответствующей закладке <span class="term"><strong class="userinput">Hardware</strong></span> нашей ВМ.</p>

   <a id="02010405"> </a>
   <p class="title"><em>Cache</em></p>
   <p>Данное ниспадающее меню позволяет нам выбирать требующийся метод кэширования, применяемый для данного образа диска.
   Мы уже изучили различные варианты кэширования в разделе <a class="link" href="Ch04.html#030304" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch04.html#030304" target="_top">Кэширование 
   образа виртуального диска</a> <a class="link" href="Ch04.html" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch04.html" target="_top">Главы 4, Системы хранения</a>. 
   Мы можем изменять необходимый вариант кэширования в любое время, даже после того, как наша ВМ полностью создана и 
   находится в рабочем состоянии. После каждого изменения варианта кэширования нам потребуется цикл отключения- включения 
   данной ВМ для разрешения нового варианта кэширования.</p>

   <a id="02010406"> </a>
   <p class="title"><em>No backup</em></p>
   <p>Если включена данная опция, соответствующий образ виртуального диска никогда не будет включаться в резервное копирование.
   По умолчанию данная опция отключена.</p>

   <a id="02010407"> </a>
   <p class="title"><em>Discard</em></p>
   <p>Образы диска в Proxmox являются разряженными (sparsed) вне зависимости от типа самого образа, что означает, что 
   такой образ диска медленно растёт по мере того, как данные сохраняются в нём. С течением времени данные создаются и 
   уничтожаются внутри файловой системы данного образа диска. Однако в разряженном образе диска, даже после удаления данных, 
   они никогда не возвращают своё свободное пространство. Сама ВМ может выдавать в отчёте правильное свободное 
   пространство хранения, однако хранилище Proxmox будет показывать более высокое использование пространства. Имеющаяся 
   опция <span class="term"><strong class="userinput">Discard</strong></span> делает возможным для определённого узла 
   возвращать обратно всё свободное пространство, которое не содержит никаких данных. Это эквивалентно опции TRIM, 
   которая была введена для устройств SSD. Прежде чем воспользоваться этим вариантом, мы обязаны убедиться что данные ВМ 
   применяют контроллер <span class="term"><strong class="userinput">VirtIO SCSI</strong></span>. Мы можем установить 
   <span class="term"><strong class="userinput">SCSI Controller Type</strong></span> в закладке 
   <span class="term"><strong class="userinput">Options</strong></span> виртуальной машины:</p>
	 <div class="figure"><a id="Fig0609"> </a>
	  <p class="title"><strong>Рисунок 6-9</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0609.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0609.jpg" width="546" height="304"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Опция <span class="term"><strong class="userinput">Discard</strong></span>может быть не применимой в некоторых 
   средах, решениях хранения и операционных системах. Проведите исчерпывающее тестирование прежде чем реализовывать её 
   в своей среде. В некоторых случаях данная опция <span class="term"><strong class="userinput">Discard</strong></span> 
   может вызывать блокирование ВМ, что потребует цикла выключения- включения. Сама ВМ потребует цикла выключения- включения 
   чтобы разрешить эту опцию после повторного включения.</p>

   <a id="02010408"> </a>
   <p class="title"><em>IO thread</em></p>
   <p>Для образов диска в KVM имеется два варианта:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p><span class="term"><strong class="userinput">IO thread</strong></span></p>
	 </li><li class="listitem">
	 <p><span class="term"><code>io=native</code></span></li>
    </ul>
    </div>
   <p>По умолчанию Proxmox применяет <span class="term"><code>io=native</code></span> для всех образов дисков пока 
   имеющаяся опция <span class="term"><strong class="userinput">IO thread</strong></span>  специально не отмечается для 
   определённого диска.</p>
   <p>Такая опция <span class="term"><strong class="userinput">IO thread</strong></span> позволяет каждому образу диска 
   иметь свои собственные потоки вместо ожидания в очереди с кем- нибудь ещё. Так как дисковый ввод/ вывод больше не 
   осуществляет ожидания, поскольку имеет свои собственные потоки, он не задерживает прочие задачи или очереди, относящиеся 
   к этой ВМ, что в свою очередь ускоряет общую производительность этой ВМ помимо всего прочего, предоставляя увеличенную 
   производительность диска. Эта опция <span class="term"><strong class="userinput">IO thread</strong></span> является 
   относительно новой в Proxmox. Имеется несколько экземпляров сообщений, в которых из- за данной опции происходила 
   блокировка ВМ. Таким образом, проводите тщательное тестирование прежде чем реализуете эту функцию в некоторой 
   промышленной среде.</p>

   <a id="020105"> </a>
   <p class="title"><strong>Закладка CPU</strong></p>
   <p>данная закладка позволяет настраивать виртуальные ЦПУ для виртуальных машин. Приводимый далее экранный снимок 
   отображает блок диалога с доступными опциями ЦПУ:</p>
	 <div class="figure"><a id="Fig0610"> </a>
	  <p class="title"><strong>Рисунок 6-10</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0610.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0610.jpg" width="630" height="463"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>

   <a id="02010501"> </a>
   <p class="title"><em>Sockets</em></p>
   <p>Эта опция служит для определения общего числа сокетов, которое может применяться в данной ВМ. Для определённой ВМ 
   мы можем использовать более одного сокета даже если её физический узел не имеет достаточного числа сокетов. Это может быть полезным 
   только в том случае, если некое приложение в этой ВМ требует от нас более одного сокета. Но это вовсе не играет в пользу 
   увеличения производительности ВМ в машине с единственным сокетом.</p>

   <a id="02010502"> </a>
   <p class="title"><em>Cores</em></p>
   <p>Данная опция служит для определения общего числа ядер, которое может применять данная ВМ. Хорошим практическим приёмом является 
   начало применения какой- то ВМ с меньшим числом ядер и затем последовательно увеличивать их по мере необходимости в 
   зависимости от нагрузки. Выделение большого числа ядер некоторой ВМ вызовет ненужную нагрузку на все доступные ресурсы 
   в данном узле. Обычно некая ВМ может предоставлять хорошую производительность с двумя или четырьмя ядрами если только она 
   не является ВМ с высокими запросами, такими как сервер удалённых рабочих мест или сервер SQL/ Exchange.</p>

   <a id="02010503"> </a>
   <p class="title"><em>Enabling NUMA</em></p>
   <p>Доступ к неоднородной памяти (<span class="term"><strong class="userinput">NUMA</strong></span>, 
   <span class="term"><strong class="userinput">non-uniform memory access</strong></span>) не является каким- то новым 
   подходом для работы с памятью в среде со множеством ЦПУ, однако это новое добавление в Proxmox VE. С применением NUMA
   оперативная память может равномерно распространяться между ЦПУ, что увеличивает производительность, поскольку более 
   нет узкого места в том, что все ЦПУ пытаются осуществлять доступ к одним и тем же банкам памяти. В Proxmox опция 
   NUMA также разрешает подключение в горячем режиме памяти и ЦПУ. Без этой опции подключение оперативной памяти и ЦПУ не работает 
   вовсе.</p>
   <p>Любой узел с более чем одним сокетом обычно осведомлён об NUMA. Следовательно, включение NUMA для ВМ в таком узле 
   привнесёт преимущества в производительность ВМ. NUMA всегда пытается удерживать определённую ВМ в одном и том же пакете 
   ЦПУ. Мы можем проверять текущее состояние NUMA в своём кластере Proxmox с применением такой команды:</p>
		<pre class="screen"><code><strong>
# numastat
		</strong></code></pre>
   <p>Эта команда отобразит все те узлы в вашем кластере, которые осведомлены о NUMA, а также их состояния 
   производительности.</p>

   <a id="02010504"> </a>
   <p class="title"><em>Type</em></p>
   <p>Это наспадающее меню для выбора типа пакета ЦПУ. По умолчанию для всех ВМ выбирается тип ЦПУ 
   <span class="term"><strong class="userinput">Default (kvm64)</strong></span>. Обычным вариантом применения 
   является случай, когда определённое приложение требует инструкции SSE или AVX. Выбирая тип ЦПУ определённого 
   хоста мы даём ВМ прямой доступ к физическому ЦПУ.</p>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>Для получения наилучшей производительности следует применять тип хоста. Тем самым ваши ВМ будут способны 
		осуществлять прямой доступ к имеющимся ЦПУ без какого бы то ни было уровня эмуляции. Именно это является 
		оптимальным видом для некоторой среды, в которой все узлы являются идентичными. Для получения максимальной 
		переносимости какой- то ВМ следует выбирать типы ЦПУ KVM или Qemu.</p></td></tr></table>
     </div>

   <a id="020106"> </a>
   <p class="title"><strong>Закладка Memory</strong></p>
   <p>Эта закладка позволяет настраивать выделение оперативной памяти определённой ВМ. Приводимый ниже моментальный 
   снимок экрана отображает блок диалога для нашего примера ВМ:</p>
	 <div class="figure"><a id="Fig0611"> </a>
	  <p class="title"><strong>Рисунок 6-11</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0611.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0611.jpg" width="630" height="463"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>В Proxmox мы можем устанавливать для ВМ фиксированную или динамическую оперативную память. Автоматический  
   диапазон также именуется как раздувание (ballooning) памяти. При установленном варианте с фиксированной памятью 
   вся оперативная память выделяется одномоментно. При установке динамической памяти оперативная память выделяется 
   на основе требований ВМ, но в рамках установленного диапазона. Автоматическое выделение памяти великолепно работает 
   вВМ Linux, однако для ВМ Windows раздувание памяти потребляет боле высокие объёмы ресурсов ЦПУ, что вызывает 
   замедление такой ВМ. Таким образом, для ВМ Windows рекомендуется везде где это возможно применять фиксированную 
   память.</p>

   <a id="020107"> </a>
   <p class="title"><strong>Закладка Network</strong></p>
   <p>Данная закладка делает возможной настройку текущего виртуального сетевого интерфейса для определённой ВМ. 
   Приводимый далее снимок экрана отображает блок диалога настройки сети для нашего примера ВМ:</p>
	 <div class="figure"><a id="Fig0612"> </a>
	  <p class="title"><strong>Рисунок 6-12</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0612.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0612.jpg" width="629" height="461"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>

   <a id="02010701"> </a>
   <p class="title"><em>Bridged mode</em></p>
   <p>Этот режим позволяет ВМ подключаться к сетевой среде с применением моста. Такая ВМ не получает прямого доступа 
   к имеющейся внешней сетевой среде. Мы можем установить VLAN ID на уровне самого узла, что сделает невозможной его 
   настройку внутри такой ВМ. Данный Режим моста (<span class="term"><strong class="userinput">Bridged 
   mode</strong></span>) также предоставляет варианты межсетевого экрана для своей ВМ. Для нашего примера мы выбрали 
   имеющийся по умолчанию мост <span class="term"><code>vmbr0</code></span> и включили его опцию 
   <span class="term"><strong class="userinput">Firewall</strong></span>.</p>

   <a id="02010702"> </a>
   <p class="title"><em>Firewall</em></p>
   <p>Чтобы разрешить межсетевой экран для сетевых интерфейсов следует пометить данную опцию. Без данной опции никаие  
   правила межсетевого экрана не будут применяться к данному интерфейсу ВМ. Более подробно мы рассмотрим имеющийся 
   межсетевой экран Proxmox в <a class="link" href="Ch09.html" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch09.html" target="_top">Главе 9, Межсетевой экран Proxmox VE</a>.</p>

   <a id="02010703"> </a>
   <p class="title"><em>NAT mode</em></p>
   <p>Это режим предоставляет ВМ прямой доступ ко внешним сетевым средам. Сентевой обмен не пропускается ни через какие мосты. 
   Если в данной сетевой среде применяется VLAN, он должен быть настроен внутри такой ВМ чтобы иметь все пакеты данных 
   помеченными или не помеченными. Опция межсетевого экрана Proxmox не доступна при использовании режима NAT.</p>

   <a id="02010704"> </a>
   <p class="title"><em>No network device</em></p>
   <p>Данный вариант создаст определённую ВМ без каког бы то ни было настроенного сетевого интерфейса.</p>

   <a id="02010705"> </a>
   <p class="title"><em>Model</em></p>
   <p>Это ниспадающее меню для выбора типа интерфейса виртуальной сетевой среды. Для максимальной сетевой 
   производительности настоятельно рекомендуется применение VirtIO. Windows не поставляется с каким бы то ни было 
   драйвером VirtIO. Следовательно, если он применяется к ВМ Windows, нам следует вручную загрузить этот драйвер из 
   ISO, который мы выгрузили в разделе <a class="link" href="Ch06.html#020104" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch06.html#020104" target="_top">Закладка Hard Disk</a> 
   этой главы. Для ВМ Windows мы также можем воспользоваться Intel E1000. Начиная с Windows 7 и выше этот драйвер 
   для Intel включён в поставку.</p>

   <a id="02010706"> </a>
   <p class="title"><em>MAC address</em></p>
   <p>По умолчанию все MAC адреса для виртуальных сетевых интерфейсов назначаются автоматически. Набрав некий MAC адрес 
   в данном текстовом блоке мы можем определить конкретный MAC адрес для данного интерфейса. Это может быть полезным в 
   случае, когда определённому приложению в данной гостевой ВМ требуется какой- то специфический MAC адрес.</p>

   <a id="02010707"> </a>
   <p class="title"><em>Rate limit (MB/s)</em></p>
   <p>Именно этот текстовый блок служит для определения максимально допустимой скорости сетевого интерфейса, определяемой 
   в Мегабайтах в секунду. Это очень полезная опция для ограничения сетевых ресурсов в ВМ. Без установки какого бы то 
   ни было значения данная ВМ будет пытаться использовать максимальную доступную полосу пропускания.</p>

   <a id="02010708"> </a>
   <p class="title"><em>Multiqueues</em></p>
   <p>Обычно ВМ KVM имеют единственную очередь в которой отправляются и принимаются все пакеты появляющиеся со временем, 
   причём не применяется никакое распараллеливание. Множественные очереди 
   (<span class="term"><strong class="userinput">Multiqueues</strong></span>) удаляют такое узкое место, делая возможной 
   одновременные отправку и приём, применяя для параллельных очередей виртуальные ядра ЦПУ. 
   <span class="term"><strong class="userinput">Множественные очереди</strong></span> особенно полезны для ВМ, которые 
   активны с большим числом клиентов, например, для некоторого веб сервера. В закладке Proxmox
   <span class="term"><strong class="userinput">Network</strong></span> в блоке диалога создания определённой ВМ мы можем 
   ввести численное значение для определения того сколько данная ВМ должна использовать очередей одновременно. Данное значение 
   не должно превосходить общее число выделенных для этой ВМ vCPU. Например, если данная ВМ имеет число ядер равное 
   четырём, мы можем установить значение <span class="term"><strong class="userinput">Multiqueues</strong></span> 
   равное <span class="term"><code>4</code></span>. <span class="term"><strong class="userinput">Множественные 
   очереди</strong></span> существенно повышают производительность сетевой среды ВМ поскольку и отправка и приём могут 
   осуществляться одновременно.</p>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>Имейте в виду, что <span class="term"><strong class="userinput">Множественные очереди</strong></span> также 
		увеличивают использование ЦПУ данной ВМ, так как каждая очередь находится в зависимости от 
		каждого vCPU.</p></td></tr></table>
     </div>

   <a id="02010709"> </a>
   <p class="title"><em>Disconnect</em></p>
   <p>Если включена данная опция, определяемый виртуальный сетевой интерфейс будет создан совместно с данной ВМ, 
   однако не будет активирован.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0202"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Создание ВМ клонированием</span></h4>
   </div></div></div>
   <p>При развёртывании множества ВМ с идентичными настройками их индивидуальное создание может стать временеёмким 
   процессом. В данном случае мы можем клонировать некую имеющуюся ВМ или какой- то шаблон. Клонирование создаёт 
   полностью независимую ВМ с идентичной конфигурацией. Такая клонированная ВМ ни коим образом не связана с той ВМ из 
   которой она клонирована. К такой опции клонирования можно получить доступ из меню контекста кликнув правой 
   кнопкой по той ВМ, которая подлежит клонированию:</p>
	 <div class="figure"><a id="Fig0613"> </a>
	  <p class="title"><strong>Рисунок 6-13</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0613.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0613.jpg" width="271" height="311"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Одним из вариантов применения клонирования является некая стратегия резервного копирования. Какая- то ВМ может 
   клонироваться в отдельные узлы, и даже в отдельную систему хранения, на постоянной основе. В случае возникновения 
   события, при котором её основной узел становится недоступным, такая клонированная ВМ может быть поднята и запущена 
   за считанные минуты без какой либо необходимости осуществления процесса восстановления. Следующий моментальный снимок 
   отображает блок диалога подобного клонирования после клика по <span class="term"><strong class="userinput">Clone</strong></span> 
   в меню имеющегося контекста:</p>
	 <div class="figure"><a id="Fig0614"> </a>
	  <p class="title"><strong>Рисунок 6-14</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0614.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0614.jpg" width="500" height="218"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   или для добавления новых приложений и тому подобного, так как первоначальная ВМ всё ещё остаётся полностью работающей 
   ВМ.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0203"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Создание ВМ из шаблона</span></h4>
   </div></div></div>
   <p>Аналогично клонированию некий шаблон также является быстрым способом развёртывания полностью настроенных ВМ без 
   прохождения через процесс полного создания ВМ и установки вручную ОС и приложений. Мы можем создать некую новую ВМ и 
   установить необходимые ОС и прочие необходимые программы перед их преобразованием в какой- то шаблон. Таким образом, 
   все вновь создаваемые из данного шаблона ВМ будут с полностью настроенными ОС и программами. Что устанавливает 
   отличие шаблона от простого клонирования, так это то, что после преобразования какой- то ВМ в шаблон она не может 
   быть вновь включена. Если для данного шаблона ВМ требуются какие- либо изменения, необходимо создать новую ВМ, настроить 
   её и затем преобразовать в шаблон. Однако, мы можем изменять имеющиеся аппаратные ресурсы конкретного шаблона. 
   Основным преимуществом применения шаблона в сравнении с клонированными ВМ состоит в том, что шаблон допускает для 
   нас как создание полностью клонированных ВМ, так и ВМ с присоединённым клоном.</p>
   <p>для создания ВМ из какого- то клона нам потребуется вначале создать такой шаблон. Мы можем выполнить это преобразовав 
   некую настроенную ВМ в шаблон. Для данного варианта мы можем пойти путём выбора необходимой ВМ с последующим кликом по 
   ней правой кнопкой и выбором <span class="term"><strong class="userinput">Convert to template</strong></span> для 
   открытия блока диалога:</p>
	 <div class="figure"><a id="Fig0615"> </a>
	  <p class="title"><strong>Рисунок 6-15</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0615.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0615.jpg" width="235" height="126"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>В этом примере мы собираемся преобразовать одну из имеющихся у нас ВМ,
   <span class="term"><strong class="userinput">102 (centos1)</strong></span>, в некий шаблон. Кликните по 
   <span class="term"><strong class="userinput">Yes</strong></span> для преобразования этой ВМ в шаблон. Как уже 
   упоминалось ранее, после того, как данная ВМ преобразована в шаблон, эта ВМ сама по себе более не может применяться. 
   Другой требующей указания разницей является то, что её иконка в инструментальной панели Proxmox является 
   уникальной для шаблонов KVM, что отображено в следующем экранном снимке:</p>
	 <div class="figure"><a id="Fig0616"> </a>
	  <p class="title"><strong>Рисунок 6-16</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0616.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0616.jpg" width="198" height="260"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>С помощью данного шаблона мы можем теперь клонировать ВМ, которые будут идентичны этому шаблону. Сама процедура 
   клонирования одна и та же, будь то ВМ или шаблон KVM. Чтобы создать некую новую ВМ или развернуть из данного 
   шаблона множество ВМ кликните правой кнопкой по выбранному шаблону чтобы открыть его контекстное меню и затем 
   кликните по опции <span class="term"><strong class="userinput">Clone</strong></span>. Это откроет требующийся блок 
   диалога клонирования, как это показано на снимке экрана внизу:</p>
	 <div class="figure"><a id="Fig0617"> </a>
	  <p class="title"><strong>Рисунок 6-17</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0617.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0617.jpg" width="581" height="253"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>

   <a id="020301"> </a>
   <p class="title"><strong>Узел назначения</strong></p>
   <p>Это ниспадающее меню для выбора того, в каком узле мы желаем создать клонированную ВМ. Это может быть тот же самый 
   узел или любой другой узел в данном кластере с достаточными ресурсами.</p>

   <a id="020302"> </a>
   <p class="title"><strong>Режим</strong></p>
   <p>В Proxmox 5.0 имеются два режима клонирования:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p><span class="term"><strong class="userinput">Full Clone</strong></span> (Полное клонирование)</p>
	 </li><li class="listitem">
	 <p><span class="term"><strong class="userinput">Linked Clone</strong></span> (Присоединённое клонирование)</p>
	 </li>
    </ul>
    </div>
   <p><span class="term"><strong class="userinput">Полное клонирование</strong></span> создаёт идентичную копию данной 
   ВМ, включая её образ виртуального диска. Это действительно изолированная ВМ, так как она никоим образом не зависит от 
   своего шаблона или ВМ источника. Даже если мы удалим сам шаблон или ВМ источника, наша вновь созданная ВМ всё ещё будет 
   работать без каких- то проблем. <span class="term"><strong class="userinput">Full Clone</strong></span> потребляет 
   столько же пространства хранения, сколько и его первоначальная ВМ, так как его виртуальный диск также клонируется. 
   Полные клоны полезны когда выделяемые ресурсы идентичны для всех оснащаемых ВМ, однако гостевые операционные 
   системы могут отличаться, а могут и быть теми же самыми.</p>
   <p><span class="term"><strong class="userinput">Присоединённый клон</strong></span> создаёт некий дубликат первоначальной 
   ВМ за вычетом самого первоначального образа виртуального диска. Это создаёт некий дополнительный пустой образ диска, 
   который ссылается на свой первоначальный виртуальный диск, причём в такой присоединённый образ клонированного диска 
   помещаются только новые данные. Все запросы на чтение, за исключением касающихся новых данных, автоматически 
   перенаправляются в его первоначальный образ диска. <span class="term"><strong class="userinput">Linked Clone</strong></span> 
   существенным образом зависит от своего шаблона или ВМ источника. Такой режим клонирования полезен в том случае, 
   когда все клонированные ВМ будут иметь в точности те же самые конфигурации оборудования и программного обеспечения, 
   в том числе и гостевую операционную систему. <span class="term"><strong class="userinput">Linked Clone</strong></span>
   потребляет намного меньше пространства хранения, так как первоначальный или базовый образ никогда не дублируется, а 
   всего лишь применяется в качестве ссылки в получаемом новом <span class="term"><strong class="userinput">Присоединённом 
   клоне</strong></span> ВМ.</p>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>Хотя мы и не можем включить имеющийся шаблон, мы всё ещё можем производить изменения его ресурсов, такие как 
		ЦПУ или Оперативная память. Однако это не рекомендуется при практическом применении, так как любое изменение 
		оборудования может создавать проблемы при включении какой- то клонированной ВМ. Также очень важно гарантировать, что 
		получаемый шаблон источника никоим образом не разрушается. Любое нарушение шаблона вызывает отказ всех присоединённых 
		клонов.</p></td></tr></table>
     </div>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="03"> </a>Расширенные параметры настройки для ВМ</h3>
   </div></div></div>
   <p>Теперь мы рассмотрим некоторые дополнительные варианты настройки, которые мы можем применять для расширения 
   имеющихся возможностей виртуальных машин KVM.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0301"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Настройка звуковых устройств</span></h4>
   </div></div></div>
   <p>В этом разделе мы собираемся рассмотреть как добавлять поддержку звуковых устройств в ВМ. По умолчанию Proxmox не 
   добавляет аудио оборудование в ВМ. Для того чтобы операционная система данной ВМ запустила службу звуковых устройств в 
   файл настроек этой ВМ следует добавить некоторые аргументы с применением CLI. Как и в Proxmox VE 4.1 невозможно 
   добавлять звуковое взаимодействие с помощью GUI. приводимые ниже шаги добавляют некое звуковое устройство в ВМ:</p>
   <div class="orderedlist">
   <ol class="orderedlist" type="1"><li class="listitem">
     <p>Зарегистрируйтесь в узле Proxmox через SSH или напрямую в консоли.</p>
	 </li><li class="listitem">
	 <p>Перейдите в каталог настроек Proxmox</p>
	   <pre class="screen"><code><strong>
/etc/pve/nodes/&lt;node_name&gt;/qemu-server/&lt;vm_id&gt;.conf
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Откройте файл настроек ВМ предпочитаемым вами редактором и добавьте следующие аргументы:</p>
	 <p>Для ВМ Windows 10 и последующих версий:</p>
	   <pre class="screen"><code>
args: -device intel-had,id=sound5,bus=pci.0,
addr=0x18 -device hda-micro,id=sound5-codec0,
bus=sound5.0,cad=0 -device had-duplex,
id=sound5-codec1,bus=sound5.0,cad=1
 	   </code></pre>
	 <p>Для ВМ Windows XP:</p>
	   <pre class="screen"><code>
args: -device AC97,addr=0x18
 	   </code></pre>
	 </li><li class="listitem">
	 <p>Сохраните этот файл настроек и выйдите из редактора.</p>
	 </li><li class="listitem">
	 <p>Выполните цикл выключения- включения для активации имеющегося звукового устройства.</p>
	 </li>
   </ol>
   </div>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0302"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Настройка проброса PCI</span></h4>
   </div></div></div>
   <p>В Proxmox имеется возможность проброса (passthrough) устройства PCI напрямую в некую ВМ. В данном разделе мы 
   собираемся рассмотреть как настроить и проверитриводимые далее шаги предназначены для включению и настройки проброса 
   устройства PCI в Proxmox:</p>
   <div class="orderedlist">
   <ol class="orderedlist" type="1"><li class="listitem">
     <p>Зарегистрируйтесь в узле Proxmox через SSH или напрямую в консоли.</p>
	 </li><li class="listitem">
	 <p>Откройте настройку файла <span class="term"><code>grub</code></span> с помощью редактора:</p>
	   <pre class="screen"><code><strong>
# nano /etc/default/grub
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Измените <span class="term"><code>GRUB_CMDLINE_LINUX_DEFAULT="quiet"</code></span> на следующее:</p>
	 <p>Для ЦПУ Intel:</p>
	   <pre class="screen"><code>
GRUB_CMDLINE_LINUX_DEFAULT="quiet intel_iommu=on"
 	   </code></pre>
	 <p>Для ЦПУ AMD:</p>
	   <pre class="screen"><code>
GRUB_CMDLINE_LINUX_DEFAULT="quiet amd_iommu=on"
 	   </code></pre>
	 </li><li class="listitem">
	 <p>Сохраните эти изменения и покиньте свой редактор.</p>
	 </li><li class="listitem">
	 <p>Для обновления <span class="term"><code>grub</code></span> выполните следующую команду:</p>
	   <pre class="screen"><code><strong>
# update-grub
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Только если вы используете ЦПУ AMD добавьте следующую строку в своём файле настроек
	 <span class="term"><code>/etc/modprobe.d/kvm_iommu_map_guest.conf</code></span>:</p>
	   <pre class="screen"><code>
options kvm allow_unsafe_assigned_interrupt=1
 	   </code></pre>
	 </li><li class="listitem">
	 <p>Убедитесь что следующие модули загружаются в <span class="term"><code>/etc/modules</code></span>:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p><span class="term"><code>vfio_iommu_type1</code></span></p>
	 </li><li class="listitem">
	 <p><span class="term"><code>vfio_virqfd</code></span></p>
	 </li><li class="listitem">
	 <p><span class="term"><code>vfio_pci</code></span></p>
	 </li><li class="listitem">
	 <p><span class="term"><code>vfio</code></span></p>
	 </li>
    </ul>
    </div>
	 </li><li class="listitem">
	 <p>Выполните повторную загрузку этого узлаProxmox.</p>
	 </li><li class="listitem">
	 <p>Определите адрес местоположения требуемого устройства PCI в виде 
	 <span class="term"><code>xx:xx.x</code></span>, воспользовавшись следующей командой:</p>
	   <pre class="screen"><code><strong>
# lspci
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Введите в свой файл настроек ВМ следующую строку с соответствующим идентификатором устройства PCI:</p>
	   <pre class="screen"><code>
machine: q35
hostpsi0: 01:00.0,pcie=1
 	   </code></pre>
	 </li><li class="listitem">
	 <p>Выполните цикл выключения- включения данной ВМ.</p>
	 </li><li class="listitem">
	 <p>Установите требующиеся драйверы для данного устройства PCI в соответствующей операционной системе ВМ.</p>
	 </li>
   </ol>
   </div>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0303"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Настройка проброса GPU</span></h4>
   </div></div></div>
   <p>В данном разделе мы собираемся рассмотреть как настроить некий видео адаптер на его прямое применение в ВМ. 
   Тот GPU, который подлежит добавлению в определённую ВМ не должен привязываться к своему узлу хоста. Чтобы убедиться, 
   что данное устройство не используется данным хостом осуществите следующие шаги:</p>
   <div class="orderedlist">
   <ol class="orderedlist" type="1"><li class="listitem">
     <p>Мы должны определить имя производителя и идентификатор устройства, того устройства GPU, которое предполагается 
	 пробрасывать. Чтобы прихватить это устройство мы можем выполнить команду 
	 <span class="term"><code>#lspci</code></span>. Данное устройство должно для нас отображаться как некий VGA совместимый 
	 контроллер. Приводимый далее снимок экрана показывает нам устройство VGA с идентификатором 
	 <span class="term"><code>00:02.0</code></span>:</p>
	 <div class="figure"><a id="Fig0618"> </a>
	  <p class="title"><strong>Рисунок 6-18</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0618.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0618.jpg" width="601" height="104"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
	 </li><li class="listitem">
	 <p>Чтобы определить идентификаторы данного устройства и его производителя выполните данную команду снова воспользовавшись 
	 следующим форматом:</p>
	   <pre class="screen"><code><strong>
#lspci -n -s 00:02
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Данная команда воспроизведёт ряд чисел. Идентификаторы устройства и производителя являются самыми последними 
	 двумя наборами чисел. Ниже приводится соответствующий набор числовых значений для нашего примера узла:</p>
	   <pre class="screen"><code><strong>
# df00:02.0 0300: 1013:00b8
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Примите во внимание этот идентификатор устройства, затем создайте некий файл 
	 <span class="term"><code>/etc/modprobe.d/vfio.conf</code></span> для определения явным образом того, чтобы 
	 данное GPU было пробрасываемым устройством <span class="term"><code>vfio</code></span> и предотвратить 
	 конфликт с назначаемым по умолчанию устройства VGA. Введите следующую строку в свой файл 
	 <span class="term"><code>vfio.conf</code></span>:</p>
	   <pre class="screen"><code>
options vfio-pci ids=1013:00b8 disable_vga
 	   </code></pre>
	 </li><li class="listitem">
	 <p>Теперь нам следует занести в чёрный список соответствующие устройства VGA по усолчанию с тем, чтобы они не 
	 загружались в процессе начального запуска следующим образом:</p>
	   <pre class="screen"><code><strong>
# echo "blacklist nvidia" &gt;&gt; /etc/modprobe.d/blacklist.conf
# echo "blacklist radeon" &gt;&gt; /etc/modprobe.d/blacklist.conf
# echo "blacklist nouveau" &gt;&gt; /etc/modprobe.d/blacklist.conf
 	   </strong></code></pre>
	 </li>
   </ol>
   </div>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>При попытке добавления проброса GPU для некоторой ВМ, важно иметь в виду, что не все устройства GPU имеют 
		возможность проброса. пробуйте различные конфигурации.</p></td></tr></table>
     </div>
   <p>На текущий момент мы теперь готовы настроить саму свою ВМ для применения проброса GPU. Рекомендуемым способом настройки является 
   проброс PCI <span class="term"><strong class="userinput">Open Virtual Machine Firmware</strong></span>
   (<span class="term"><strong class="userinput">OVMF</strong></span>, Открытого встроенного ПО ВМ). OVMF является 
   проектом для разрешения ВМ применения BIOS <span class="term"><strong class="userinput">UEFI</strong></span>
   (<span class="term"><strong class="userinput">Unified Extensible Firmware Interface</strong></span>). Для 
   поддержки свойств OVMF используемая гостевая операционная система обязана поддерживать UEFI. Последующие шагни 
   помогут нам определить совместимость данного устройства GPU с UEFI:</p>
   <div class="orderedlist">
   <ol class="orderedlist" type="1"><li class="listitem">
     <p>Зарегистрируйтесь в своём узле с устройством GPU воспользовавшись SSH.</p>
	 </li><li class="listitem">
	 <p>Выполните следующие команды для выгрузки и компиляции некоего инструмента, который в свою очередь выгрузит 
	 содержимое ROM устройства вашего GPU:</p>
	   <pre class="screen"><code><strong>
# git clone https://github.com/awilliam/rom-parser
# cd rom-parser
# make
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Исполните следующий набор команд для выгрузки содержимого ROM вашего устройства GPU во временный каталог:</p>
	   <pre class="screen"><code><strong>
# cd /sys/bus/pci/devices/0000:01:00.0/
# echo 1 &gt; rom
# cat rom &gt; /home/rom-parser/image.rom
# echo 0 &gt; rom
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Выполните приводимую далее команду чтобы проверить свой выгруженный ROM с помощью синтаксического анализатора ROM, 
	 который мы загрузили ранее и выполнить компиляцию на предмет определения того, является ли наше GPU UEFI 
	 совместимым:</p>
	   <pre class="screen"><code><strong>
# cd /home/rom-parser
# ./rom-parser /tmp/image.rom
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Эта команда отобразит информацию, похожую на следующее:</p>
	   <pre class="screen"><code>
Valid ROM signature found @0h, PCIR offset 60h
PCIR: type 3, vendor 102b, device: 0532, class: 030000
PCIR: revision 0, vendor revision: 2139
EFI: Signature Valid
Last image
 	   </code></pre>
	 </li>
   </ol>
   </div>
   <p>Если PCIR имеет <span class="term"><code>type 3</code></span>, тогда наше устройство GPU является UEFI/ OVMF
   совместимым.</p>
   <p>Соответствующая настройка ВМ должна выглядеть подобно приводимой ниже после выбора BIOS OVMF и добавить 
   необходимую строку <span class="term"><code>hostpci</code></span>. Осуществите необходимые изменения и затем 
   выполните цикл отключения- включения чтобы активировать эти новые настройки.</p>
	   <pre class="screen"><code>
bios: ovmf
scsihw: virtio-scsi-pci
machine: q35
hostpci0: 02:00,pcie=1,x-vga=on
....................
....................
 	   </code></pre>
   <p>При использовании GPU устройств nVidia, таких как  GeForce Experience, могут возникать ситуации, приводящие к краху 
   виртуальной машины. В подобных случаях добавьте в <span class="term"><code>/etc/modprobe.d/kvm.conf</code></span> 
   приводимую ниже строку. Данная проблема может возникать при применении такого программного обеспечения как 
   PassMark PerformanceTest и SiSoftware Sandra:</p>
	   <pre class="screen"><code>
options kvm ignore_msrs=1
 	   </code></pre>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0304"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Подготовка к подключению во время работы</span></h4>
   </div></div></div>
   <p>В данном разделе мы намереваемся рассмотреть как настраивать опцию горячего подключения в виртуальных машинах Proxmox. 
   применяя функциональность подключения в горячем режиме мы можем добавлять или удалять устройства или ресурсы в 
   некоторой ВМ без выполнения в ней цикла отключения- включения. Для Proxmox 5.0 мы можем применять варианты подключения в 
   горячем режиме для следующих устройств:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p>Дисков</p>
	 </li><li class="listitem">
	 <p>Сетевых интерфейсов</p>
	 </li><li class="listitem">
	 <p>ЦПУ</p>
	 </li><li class="listitem">
	 <p>Оперативной памяти</p>
	 </li><li class="listitem">
	 <p>USB</p>
	 </li>
    </ul>
    </div>
   <p>В версии Proxmox 5.0 мы можем увеличивать ЦПУ и Оперативную память, но не можем уменьшать их. относительно 
   дисков и сетевых интерфейсов мы можем одинаково их и подключать в горячем режиме и отключать по- горячему. 
   Следующая таблица показывает какие типы устройств поддерживаются в различных операционных системах:</p>
        <a class="link" href="Ch01.html#table0101" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/Ch01.html#table0101" target="_top">Таблице 1-1</a>
		</p>
        <table rules="all" width="700" style="text-align:left; border-style:none;" id="table0601">
        <caption>Таблица 6-1. Права доступа</caption>
		<col width="15%"/><col width="20%"/><col width="30%"/><col width="35%"/><thead><tr valign="top">
          <th style="border-bottom:1;border-top:1;">Устройство</th>
          <th style="border-bottom:1;border-top:1;">Ядро</th>
          <th style="border-bottom:1;border-top:1;">Подключение/ отключение в горячем режиме</th>
          <th style="border-bottom:1;border-top:1;">ОС</th>
        </tr></thead><tr valign="top">
          <td style="border-style:none;"><p>Диск</p></td>
          <td style="border-style:none;"><p>Все</p></td>
          <td style="border-style:none;"><p>Оба</p></td>
          <td style="border-style:none;"><p>Все версии Linux/ Windows</p></td>
        </tr><tr valign="top">
          <td style="border-style:none;"><p>NIC</p></td>
          <td style="border-style:none;"><p>Все</p></td>
          <td style="border-style:none;"><p>Оба</p></td>
          <td style="border-style:none;"><p>Все версии Linux/ Windows</p></td>
        </tr><tr valign="top">
          <td style="border-style:none;"><p>ЦПУ</p></td>
          <td style="border-style:none;"><p>Выше 3.1</p></td>
          <td style="border-style:none;"><p>Для Windows только подключение,</p>
		  <p>в Linux и то и другое</p></td>
          <td style="border-style:none;"><p>Все версии Linux,</p>
		  </p>Windows Server 2008 и старше</p></td>
        </tr><tr valign="top">
          <td style="border-style:none;"><p>Оперативная память</p></td>
          <td style="border-style:none;"><p>Выше 3.1</p></td>
          <td style="border-style:none;"><p>Для Windows только подключение,</p>
		  <p>в Linux и то и другое</p></td>
          <td style="border-style:none;"><p>Все версии Linux,</p>
		  </p>Windows Server 2008 и старше</p></td>
        </tr></tbody></table>
   <p>Хотя все основные настройки для включения подключения в горячем режиме для Proxmox следует проводить в CLI, 
   мы можем разрешать и запрещать подключаемые в горячем реиме устройства через меню закладок 
   <span class="term"><strong class="userinput">Datacenter | Node | VM | Options</strong></span>, как это отображено 
   на следующем снимке экрана:</p>
	 <div class="figure"><a id="Fig0619"> </a>
	  <p class="title"><strong>Рисунок 6-19</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0619.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0619.jpg" width="630" height="479"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Прежде чем горячее подключение будет применено, нам необходимо подготовить ВМ на основе Linux. Для подключения 
   в горячем режиме в гостевой операционной системе Linux необходимо выполнить загрузку двух модулей. Мы можем загрузить 
   эти модули воспользовавшись следующими командами:</p>
		<pre class="screen"><code><strong>
# modprobe acpiphp
# modprobe pci_hotplug
		</strong></code></pre>
   <p>Для их автоматической загрузки в процессе начального запуска мы можем добавить их в 
   <span class="term"><code>/etc/modules</code></span>.</p>
   <p>В тех гостевых ОС Linux, которые основываются на Ядре с версией ниже 4.7 нам потребуется создать новый файл правил 
   <span class="term"><code>udev</code></span> в файле <span class="term"><code>/lib/udev/rules.d/80-hotplug-cpu-mem.rules</code></span> 
   и добавить в него следующие строки:</p>
	   <pre class="screen"><code>
SUBSYSTEM=="cpu",ACTION=="add",TEST=="online",ATTR{online}=="0",
ATTR=={online}="1"
SUBSYSTEM=="memory",ACTION=="add",TEST=="state",
ATTR{state}=="offline",ATTR=={state}="online"
 	   </code></pre>
   <p>Для госетвых операционных систем основанных на Ядре 4.7 или более новых, нам не нужно добавлять такие правила 
   <span class="term"><code>udev</code></span>, для подключения оперативной памяти в горячем режиме,однако нам всё 
   ещё потребуются параметры для ЦПУ. Нам понадобится добавить следующий параметр ядра в процессе начального запуска:</p>
	   <pre class="screen"><code>
memhp_default_state=online
 	   </code></pre>
   <p>Для разрешения подключения памяти в горячем режиме нам следует выполнить следующие шаги для добавления параметров 
   ядра начальной загрузки:</p>
   <div class="orderedlist">
   <ol class="orderedlist" type="1"><li class="listitem">
     <p>В SSH гостевой ОС Linux выполните следующую команду:</p>
	   <pre class="screen"><code><strong>
#gksudo gedit /etc/default/grub
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Определите местоположение строки, начинающейся с <span class="term"><code>GRUB_CMDLINE_LINUX_DEFAULT</code></span> 
	 и наберите необходимый параметр ядра в самом конце этой строки. Данная строка теперь должна выглядеть следующим 
	 образом:</p>
	   <pre class="screen"><code>
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash memhp_default_state=online"
 	   </code></pre>
	 </li><li class="listitem">
	 <p>Сохраните этот файл и покиньте свой редактор.</p>
	 </li><li class="listitem">
	 <p>Для обновления начального загрузчика <span class="term"><code>grub</code></span> выполните следующую 
	 команду:</p>
	   <pre class="screen"><code><strong>
# sudo update-grub
 	   </strong></code></pre>
	 </li><li class="listitem">
	 <p>Для активации всех модулей, правил и параметра ядра Proxmox потребуется цикл отключения- включения.</p>
	 </li><li class="listitem">
	 <p>После перезагрузки выполните следующую команду чтобы проверить какие параметры ядра загружены при начальном 
	 запуске.</p>
	   <pre class="screen"><code><strong>
# cat /proc/cmdline
 	   </strong></code></pre>
	 </li>
   </ol>
   </div>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0305"> </a>
	<span  style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Настройка подключения во время работы</span></h4>
   </div></div></div>
   <p>Для подключения в горячем режиме ЦПУ и Оперативной памяти нам также необходимо проверить, что для данной ВМ 
   включена опция NUMA. Опцию NUMA можно отыскать в меню
   <span class="term"><strong class="userinput">Datacenter | Node | VM | Hardware | Processors</strong></span>. 
   Для открытия блока диалога ЦПУ кликните <span class="term"><strong class="userinput">Edit</strong></span>:</p>
	 <div class="figure"><a id="Fig0620"> </a>
	  <p class="title"><strong>Рисунок 6-20</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0620.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0620.jpg" width="629" height="197"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Для настройки горячего подключения диска или сетевого интерфейса не требуются никакие дополнительные настройки.</p>

   <a id="020501"> </a>
   <p class="title"><strong>Подключение vCPU в горячем режиме</strong></p>
   <p>Для добавления виртуального ЦПУ или vCPU проследуйте в меню 
   <span class="term"><strong class="userinput">Datacenter | Node | VM | Hardware</strong></span>, затем выберите 
   <span class="term"><strong class="userinput">Processors</strong></span> и кликните по 
   <span class="term"><strong class="userinput">Edit</strong></span> для открытия необходимого блока диалога. 
   просто наберите требуемое число ядер или воспользуйтесь стрелками опций вверх и вниз в данном тексте для выбора 
   требующегося числа ядер или vCPU. Кликните по <span class="term"><strong class="userinput">OK</strong></span> 
   для принятия изменений. В этом блоке диалога мы также можем добавить новый ЦПУ. Также мы можем добавлять vCPU 
   исполняя в CLI своего узла Proxmox следующую команду:</p>
		<pre class="screen"><code><strong>
# qm set &lt;vm_id&gt; -vcpus 2
		</strong></code></pre>
   <p>Поскольку в нашем примере ВМ уже имеется один ЦПУ, наша предыдущая команда добавит дополнительный ЦПУ, доведя 
   общее число ЦПУ в этой ВМ до двух.</p>

   <a id="020502"> </a>
   <p class="title"><strong>Подключение оперативной памяти в горячем режиме</strong></p>
   <p>Чтобы открыть соответствующий блок диалога для изменения выделяемой оперативной памяти проследуйте в меню 
   <span class="term"><strong class="userinput">Datacenter | Node | VM | Hardware</strong></span>. Выберите 
   <span class="term"><strong class="userinput">Memory</strong></span> и затем кликните по 
   <span class="term"><strong class="userinput">Edit</strong></span> для открытия необходимого блока диалога памяти.</p>
	 <div class="figure"><a id="Fig0621"> </a>
	  <p class="title"><strong>Рисунок 6-21</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0621.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0621.jpg" width="630" height="315"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>Измените подлежащий выделению объём памяти, а затем кликните <span class="term"><strong class="userinput">OK</strong></span>
   для принятия этих изменений. Проверьте что опция NUMA разрешена в вашем блоке диалога 
   <span class="term"><strong class="userinput">Processors</strong></span>, что уже обсуждалось в данном разделе.</p>

   <a id="020503"> </a>
   <p class="title"><strong>Подключение дисков/ vNIC в горячем режиме</strong></p>
   <p>Для подключения в горячем режиме нового диска или сетевого интерфейса проследуйте в меню 
   <span class="term"><strong class="userinput">Datacenter | Node | VM | Hardware</strong></span> и затем выберите 
   некий элемент из ниспадающего меню <span class="term"><strong class="userinput">Add</strong></span>. 
   Получаемые блоки диалога для добавления этих ресурсов аналогичны тем блокам диалога процесса создания ВМ, 
   которые мы уже наблюдали в более ранних разделах данной главы. На следующем снимке экрана показано ниспадающее 
   меню <span class="term"><strong class="userinput">Add</strong></span>:</p>
	 <div class="figure"><a id="Fig0622"> </a>
	  <p class="title"><strong>Рисунок 6-22</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0622.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0622.jpg" width="501" height="152"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
	 <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Совет"><tr><td rowspan="2" align="center" valign="top" width="25">
        <img alt="[Совет]" src="tip.png" tppabs="http://onreader.mdl.ru/common/images/admon/tip.png"/></td><th align="left">Совет</th></tr><tr><td align="left" valign="top">
        <p>Хотя подключение в горячем режиме ЦПУ и Оперативной памяти работают и в Linux, и в Windows, убедитесь в этом 
		проведя надлежащее тестирование прежде чем реализуете их в своей промышленной среде. Добавление в горячем 
		режиме ЦПУ/ Оперативной памяти может вызывать некие нестабильные ситуации для вашей ВМ, вызывая её замораживания 
		и требуя полной перезагрузки..</p></td></tr></table>
     </div>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="04"> </a>Миграция виртуальных машин KVM</h3>
   </div></div></div>
   <p>Миграция Proxmox делает возможным перемещение виртуальных машин KVM в некий узел Proxmox как в отключённом режиме, 
   так и во включённом состоянии (по- живому). Наиболее распространённым сценарием миграции ВМ является тот случай, когда некоторому 
   узлу Proxmox требуется перезагрузка в результате основополагающего обновления ядра или прочих исправлений. Прочие ситуации 
   могут включать в себя отказы оборудования, замену узла, проблемы с программным обеспечением и тому подобное. 
   Без наличия соответствующего варианта миграции в реальном времени любая перезагрузка была бы очень сложной для 
   администратора, так как все работающие ВМ следовало бы отключить прежде чем произвести такой процесс перезагрузки. 
   Это может вызывать существенное время простоя в критически важных виртуальных средах.</p>
   <p>При наличии варианта с миграцией в реальном времени некая работающая ВМ может быть перемещена на другой узел без 
   времени простоя. В процессе миграции в реальном времени данная ВМ не претерпевает никаких основных остановов. 
   После перезагрузки её основного узла просто выполните миграцию этой ВМ обратно на него. Любые отключённые ВМ также 
   запросто могут перемещаться.</p>
   <p>Proxmox придерживается очень минималистского подхода к своему процессу миграции. Для доступа к необходимому процессу миграции 
   кликните правой кнопкой по той ВМ, которая подлежит миграции, для открытия её контекстного меню и затем выберите 
   <span class="term"><strong class="userinput">Migration</strong></span> или кликните по кнопке 
   <span class="term"><strong class="userinput">Migratioe</strong></span> в правом верхнем углу для открытия требуемого 
   блока диалога. Приводимый ниже снимок экрана отображает такой блок диалога миграции:</p>
	 <div class="figure"><a id="Fig0623"> </a>
	  <p class="title"><strong>Рисунок 6-23</strong></p>
	  <div class="figure-contents"><div class="mediaobject">
	  <img src="Fig0623.jpg" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/figures/Fig0623.jpg" width="362" height="161"/><br />
	  <span></span>
	  </div></div>
	 </div><br class="figure-break"/>
   <p>В этом блоке диалога просто выберите необходимый узел назначения, а после этого, в зависимости от того выполяется 
   ли миграция в отключённом режиме или в реальном времени, кликните на соответствующий флаговый блок. Затем нажмите 
   имеющуюся клавишу <span class="term"><strong class="userinput">Migrate</strong></span> для того, чтобы начать процесс миграции.
   В зависимости от размера виртуального диска выделенной данной ВМ оперативной памяти время процесса миграции может быть 
   различным. Миграция в реальном времени/ во включённом состоянии, помимо всего прочего, также перемещает всё содержимое 
   оперативной памяти данной ВМ. Чем больше выделенная оперативная память, тем длиннее будет процесс миграции. В своём 
   предыдущем примере мы осуществили миграцию в режиме реального времени миграцию ВМ с идентификатором 
   <span class="term"><code>#103</code></span> на узел <span class="term"><code>pmx-02</code></span>.</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="05"> </a>Выводы</h3>
   </div></div></div>
   <p>В данной главе мы рассмотрели виртуальные машины KVM и то, как создавать, клонировать и мигрировать их при необходимости. 
   Мы рассмотрели также некий расширенные настройки, такие как добавление звукового оборудования и включение проброса 
   PCI/ GPU для ВМ RVM. Вооружаясь такой мощностью клонирования мы можем без усилий масштабировать виртуальный кластер 
   при оснащении идентичных виртуальных машин. Также были объяснены опциональные и не используемые в промышленной реализации 
   установки встраиваемых виртуальных сред.</p>
   <p>Наилучшей практикой использования виртуальных машин KVM являются случаи применения всех операционных систем, 
   отличающихся от Linux, а также когда обязательна общая изоляция всех ресурсов между Вм.</p>
   <p>В своей следующей главе мы собираемся рассмотреть более подробно контейнеры LXC. Мы изучим почему администраторам Proxmox 
   следует выбирать их вместо виртуальных машин KVM.</p>
  </div>
 </div>

<!----><script type="text/javascript" src="FooterAndSidebar.js" tppabs="http://onreader.mdl.ru/MasteringProxmox.3ed/content/FooterAndSidebar.js">
</script><script type="text/javascript"><!--</div id="content"> is inside next code
document.write(FooterAndSidebar);//-->
</script>

</body></html>